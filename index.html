<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ¸ æºæºåˆ·æœºåŠ©æ‰‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --main-pink: #ff7eb9;
            --light-pink: #ffb8d9;
            --lighter-pink: #ffe6f0;
            --accent-lavender: #d5b8ff;
            --accent-mint: #7fffd4;
            --accent-yellow: #ffd700;
            --text-dark: #5a5a5a;
            --text-light: #888;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #ffe6f0, #f0f8ff);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-dark);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            position: relative;
        }
        
        .header h1 {
            font-size: 3.2rem;
            color: #ff6b9d;
            margin-bottom: 10px;
            text-shadow: 3px 3px 0 rgba(255, 182, 193, 0.3);
            position: relative;
            display: inline-block;
        }
        
        .header h1::before, .header h1::after {
            content: 'ğŸŒ¸';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
        }
        
        .header h1::before { left: -50px; }
        .header h1::after { right: -50px; }
        
        .tagline {
            color: #6a6aff;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .cute-container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 40px rgba(255, 182, 193, 0.2);
            border: 3px solid var(--main-pink);
            position: relative;
            overflow: hidden;
        }
        
        .cute-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, 
                #ff7eb9, #ffb8d9, #d5b8ff, #7fffd4, #ffd700);
        }
        
        /* æ•™ç¨‹æŒ‰é’® */
        .help-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff7eb9, #ff6b9d);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(255, 126, 185, 0.4);
            z-index: 1000;
            transition: all 0.3s ease;
            border: 3px solid white;
        }
        
        .help-button:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 8px 25px rgba(255, 126, 185, 0.6);
        }
        
        /* æ•™ç¨‹å¼¹çª— */
        .tutorial-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        .tutorial-content {
            background: white;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            border: 3px solid var(--main-pink);
            animation: slideUp 0.4s ease;
        }
        
        .tutorial-header {
            background: linear-gradient(135deg, #ff7eb9, #ffb8d9);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }
        
        .tutorial-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .close-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            color: #ff7eb9;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 24px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .close-button:hover {
            transform: rotate(90deg);
            background: #ff7eb9;
            color: white;
        }
        
        .tutorial-body {
            padding: 30px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .tutorial-section {
            margin-bottom: 30px;
        }
        
        .tutorial-section h3 {
            color: #ff6b9d;
            font-size: 1.5rem;
            margin-bottom: 15px;
            padding-left: 15px;
            border-left: 5px solid #ff7eb9;
        }
        
        .step {
            background: #fff5f9;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 2px solid #ffd1e0;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #ff7eb9;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .warning-box {
            background: #fff9f0;
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .warning-title {
            color: #e6a700;
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .agree-box {
            text-align: center;
            margin: 30px 0;
        }
        
        .agree-checkbox {
            margin-right: 10px;
        }
        
        .status-box {
            background: linear-gradient(135deg, #fff5f9, #fff0f5);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 3px solid var(--main-pink);
            position: relative;
        }
        
        .status-box h2 {
            color: #ff6b9d;
            font-size: 1.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .status-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ffaaa5;
            animation: pulse 2s infinite;
        }
        
        .status-dot.connected {
            background: #7fffd4;
            box-shadow: 0 0 15px #7fffd4;
        }
        
        .status-text {
            font-size: 1.1rem;
            flex: 1;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .cute-button {
            padding: 14px 25px;
            border: none;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 140px;
        }
        
        .cute-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        .cute-button:active {
            transform: translateY(-1px);
        }
        
        .cute-button:disabled {
            background: #e0e0e0 !important;
            color: #aaa !important;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .btn-connect {
            background: linear-gradient(135deg, #ff7eb9, #ff6b9d);
            color: white;
        }
        
        .btn-disconnect {
            background: linear-gradient(135deg, #d5b8ff, #b89fff);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #7fffd4, #5fffc3);
            color: #333;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffd700, #ffc800);
            color: #333;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ffaaa5, #ff8a85);
            color: white;
        }
        
        .function-box {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 3px solid var(--accent-lavender);
            box-shadow: 0 5px 15px rgba(213, 184, 255, 0.1);
        }
        
        .function-box h2 {
            color: #9d6bff;
            font-size: 1.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .cute-input {
            width: 100%;
            padding: 15px 20px;
            border: 3px solid #ffd1e0;
            border-radius: 15px;
            font-size: 1.1rem;
            margin: 10px 0;
            transition: all 0.3s ease;
        }
        
        .cute-input:focus {
            outline: none;
            border-color: var(--main-pink);
            box-shadow: 0 0 0 3px rgba(255, 126, 185, 0.2);
        }
        
        .quick-commands {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .quick-btn {
            padding: 8px 16px;
            background: #f8f0ff;
            border: 2px solid #e0d0ff;
            border-radius: 15px;
            color: #9d6bff;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }
        
        .quick-btn:hover {
            background: #e0d0ff;
            transform: translateY(-2px);
        }
        
        .result-box {
            background: #f8fcff;
            border: 3px solid #a6d8ff;
            border-radius: 15px;
            padding: 20px;
            min-height: 120px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            white-space: pre-wrap;
            margin-top: 15px;
        }
        
        .progress-container {
            display: none;
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff7eb9, #d5b8ff, #7fffd4);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 8px;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .log-box {
            background: #fff9ff;
            border: 3px solid #ffd1e0;
            border-radius: 15px;
            padding: 20px;
            height: 300px;
            overflow-y: auto;
        }
        
        .log-entry {
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 12px;
            background: white;
            border-left: 5px solid;
            animation: slideIn 0.3s ease;
        }
        
        .log-time {
            color: #aaa;
            font-size: 0.8rem;
            margin-right: 10px;
        }
        
        .log-info { border-left-color: #4a90e2; }
        .log-success { border-left-color: #52c41a; }
        .log-error { border-left-color: #ff4d4f; }
        .log-warning { border-left-color: #faad14; }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px dashed var(--light-pink);
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .tip-box {
            background: #fff9f0;
            border: 2px dashed #ffd700;
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            color: #e6a700;
        }
        
        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2rem;
            }
            
            .header h1::before,
            .header h1::after {
                display: none;
            }
            
            .cute-container {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .cute-button {
                width: 100%;
            }
            
            .help-button {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 24px;
            }
            
            .tutorial-content {
                width: 95%;
                max-height: 85vh;
            }
        }
    </style>
</head>
<body>
    <!-- æ•™ç¨‹æŒ‰é’® -->
    <div class="help-button" id="helpButton">ğŸ’–</div>
    
    <!-- æ•™ç¨‹å¼¹çª— -->
    <div class="tutorial-modal" id="tutorialModal">
        <div class="tutorial-content">
            <div class="tutorial-header">
                <h2>ğŸŒ¸ ä½¿ç”¨æ•™ç¨‹ & æ³¨æ„äº‹é¡¹</h2>
                <p>æºæºåˆ·æœºåŠ©æ‰‹ä½¿ç”¨æŒ‡å—ï½</p>
                <div class="close-button" id="closeTutorial">&times;</div>
            </div>
            
            <div class="tutorial-body">
                <div class="tutorial-section">
                    <h3>ğŸ“± å‡†å¤‡å·¥ä½œ</h3>
                    <div class="step">
                        <span class="step-number">1</span> ç¡®ä¿ä½¿ç”¨ Edge æµè§ˆå™¨æˆ– Chrome æµè§ˆå™¨
                    </div>
                    <div class="step">
                        <span class="step-number">2</span> å‡†å¤‡ä¸€æ¡ OTG æ•°æ®çº¿
                    </div>
                    <div class="step">
                        <span class="step-number">3</span> æ‰‹æœºè¦è¿›å…¥ Fastboot æ¨¡å¼ï¼ˆå…³æœºåæŒ‰éŸ³é‡ä¸‹+ç”µæºé”®ï¼‰
                    </div>
                </div>
                
                <div class="tutorial-section">
                    <h3>ğŸš€ ä½¿ç”¨æ–¹æ³•</h3>
                    <div class="step">
                        <span class="step-number">1</span> ç‚¹å‡»"è¿æ¥è®¾å¤‡"æŒ‰é’®
                    </div>
                    <div class="step">
                        <span class="step-number">2</span> åœ¨æµè§ˆå™¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©ä½ çš„æ‰‹æœº
                    </div>
                    <div class="step">
                        <span class="step-number">3</span> è¿æ¥æˆåŠŸåå°±å¯ä»¥ä½¿ç”¨å„ç§åŠŸèƒ½å•¦ï¼
                    </div>
                </div>
                
                <div class="tutorial-section">
                    <h3>âœ¨ åŠŸèƒ½è¯´æ˜</h3>
                    <div class="step">
                        <strong>ğŸ“ é•œåƒåˆ·å†™ï¼š</strong> é€‰æ‹©é•œåƒæ–‡ä»¶ï¼Œè¾“å…¥åˆ†åŒºåç§°ï¼Œç‚¹å‡»åˆ·å†™
                    </div>
                    <div class="step">
                        <strong>ğŸš€ ä¸´æ—¶å¯åŠ¨ï¼š</strong> æµ‹è¯•é•œåƒè€Œä¸åˆ·å…¥æ‰‹æœº
                    </div>
                    <div class="step">
                        <strong>ğŸ§¹ æ“¦é™¤åˆ†åŒºï¼š</strong> æ¸…é™¤æŒ‡å®šçš„åˆ†åŒºæ•°æ®
                    </div>
                    <div class="step">
                        <strong>ğŸ’¥ æ¸…é™¤æ•°æ®ï¼š</strong> æ¸…é™¤æ‰‹æœºä¸Šçš„æ‰€æœ‰ç”¨æˆ·æ•°æ®
                    </div>
                    <div class="step">
                        <strong>ğŸ”“ è§£é”/é”å®šï¼š</strong> è§£é”æˆ–é”å®šæ‰‹æœºçš„ Bootloader
                    </div>
                </div>
                
                <div class="warning-box">
                    <div class="warning-title">âš ï¸ é‡è¦è­¦å‘Š</div>
                    <p>1. åˆ·æœºæœ‰é£é™©ï¼Œæ“ä½œå‰è¯·<strong>åŠ¡å¿…å¤‡ä»½é‡è¦æ•°æ®</strong>ï¼</p>
                    <p>2. é”™è¯¯çš„åˆ·æœºæ“ä½œå¯èƒ½å¯¼è‡´æ‰‹æœºæ— æ³•å¼€æœºï¼</p>
                    <p>3. è§£é” Bootloader å¯èƒ½å¯¼è‡´ä¿ä¿®å¤±æ•ˆï¼</p>
                    <p>4. è¯·ç¡®ä¿ä½¿ç”¨çš„é•œåƒæ–‡ä»¶ä¸ä½ çš„æ‰‹æœºå‹å·åŒ¹é…ï¼</p>
                    <p>5. æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ï¼</p>
                </div>
                
                <div class="warning-box">
                    <div class="warning-title">ğŸ“„ å…è´£å£°æ˜</div>
                    <p>æœ¬äººï¼ˆå¼€å‘è€…"æºæº"ï¼‰ä¸å¯¹ä½¿ç”¨æœ¬å·¥å…·é€ æˆçš„ä»»ä½•æŸå¤±è´Ÿè´£ã€‚</p>
                    <p>ä½¿ç”¨æœ¬å·¥å…·å³è¡¨ç¤ºæ‚¨åŒæ„è‡ªè¡Œæ‰¿æ‹…æ‰€æœ‰é£é™©ã€‚</p>
                    <p>åŒ…æ‹¬ä½†ä¸é™äºï¼šæ•°æ®ä¸¢å¤±ã€è®¾å¤‡å˜ç –ã€ä¿ä¿®å¤±æ•ˆç­‰åæœã€‚</p>
                    <p>è¯·åœ¨äº†è§£åˆ·æœºé£é™©çš„å‰æä¸‹è°¨æ…æ“ä½œï¼</p>
                </div>
                
                <div class="agree-box">
                    <label>
                        <input type="checkbox" id="agreeCheckbox" class="agree-checkbox">
                        æˆ‘å·²é˜…è¯»å¹¶ç†è§£ä¸Šè¿°è­¦å‘Šå’Œå…è´£å£°æ˜ï¼Œè‡ªæ„¿ä½¿ç”¨æœ¬å·¥å…·
                    </label>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button id="agreeButton" class="cute-button btn-connect" style="min-width: 200px;" disabled>
                        æˆ‘åŒæ„ï¼Œå¼€å§‹ä½¿ç”¨
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="header">
        <h1>ğŸŒ¸ æºæºåˆ·æœºåŠ©æ‰‹</h1>
        <p class="tagline">âœ¨ ç”¨Edgeæµè§ˆå™¨å°±èƒ½ç»™æ‰‹æœºåˆ·æœºå•¦ï¼</p>
    </div>
    
    <div class="cute-container">
        <!-- è®¾å¤‡çŠ¶æ€ -->
        <div class="status-box">
            <h2><span class="emoji">ğŸ“±</span> è®¾å¤‡çŠ¶æ€</h2>
            <div class="status-indicator">
                <div class="status-dot" id="statusDot"></div>
                <div class="status-text" id="statusText">å“å‘€ï¼Œè¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½ å…ˆè¿æ¥æ‰‹æœºå§ï¼</div>
            </div>
            <div class="button-group">
                <button id="connectBtn" class="cute-button btn-connect">ğŸ”Œ è¿æ¥è®¾å¤‡</button>
                <button id="disconnectBtn" class="cute-button btn-disconnect" disabled>ğŸ”‹ æ–­å¼€è¿æ¥</button>
                <button id="refreshBtn" class="cute-button btn-secondary">ğŸ”„ åˆ·æ–°çŠ¶æ€</button>
            </div>
        </div>
        
        <!-- Fastbootå‘½ä»¤ -->
        <div class="function-box">
            <h2><span class="emoji">ğŸ¯</span> Fastbootå‘½ä»¤</h2>
            <p style="color: #888; margin-bottom: 15px;">è¾“å…¥Fastbootå‘½ä»¤ï¼ŒæŒ‰å›è½¦æˆ–ç‚¹å‡»æŒ‰é’®æ‰§è¡Œï½</p>
            <input type="text" id="commandInput" class="cute-input" placeholder="æ¯”å¦‚ï¼šgetvar all å¯ä»¥æŸ¥çœ‹è®¾å¤‡ä¿¡æ¯å“¦ï¼" />
            
            <div class="quick-commands">
                <div class="quick-btn" onclick="document.getElementById('commandInput').value='getvar all'">è·å–è®¾å¤‡ä¿¡æ¯</div>
                <div class="quick-btn" onclick="document.getElementById('commandInput').value='devices'">æŸ¥çœ‹è®¾å¤‡åˆ—è¡¨</div>
                <div class="quick-btn" onclick="document.getElementById('commandInput').value='reboot'">é‡å¯è®¾å¤‡</div>
                <div class="quick-btn" onclick="document.getElementById('commandInput').value='reboot bootloader'">é‡å¯åˆ°Fastboot</div>
                <div class="quick-btn" onclick="document.getElementById('commandInput').value='oem device-info'">æŸ¥çœ‹è®¾å¤‡ä¿¡æ¯</div>
            </div>
            
            <div class="button-group">
                <button id="executeBtn" class="cute-button btn-connect">ğŸš€ æ‰§è¡Œå‘½ä»¤</button>
                <button id="clearResultBtn" class="cute-button btn-secondary">ğŸ§¹ æ¸…ç©ºç»“æœ</button>
            </div>
            
            <div class="result-box" id="resultBox">å‘½ä»¤ç»“æœä¼šåœ¨è¿™é‡Œæ˜¾ç¤ºå“¦ï½ è¯•è¯•çœ‹å§ï¼</div>
        </div>
        
        <!-- é•œåƒåˆ·å†™ -->
        <div class="function-box">
            <h2><span class="emoji">ğŸ“</span> é•œåƒåˆ·å†™</h2>
            <p style="color: #888; margin-bottom: 15px;">é€‰æ‹©è¦åˆ·å†™çš„é•œåƒæ–‡ä»¶ï¼Œç„¶åé€‰æ‹©åˆ†åŒºï½</p>
            
            <input type="file" id="flashFile" class="cute-input" accept=".img" />
            <input type="text" id="flashPartition" class="cute-input" placeholder="åˆ†åŒºåç§°ï¼Œæ¯”å¦‚ï¼šboot, system, recovery" value="boot" />
            
            <div class="progress-container" id="progressContainer">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">ç­‰å¾…å¼€å§‹...</div>
            </div>
            
            <div class="tip-box">
                ğŸ’¡ å°æç¤ºï¼šåˆ·æœºå‰è®°å¾—å¤‡ä»½é‡è¦æ•°æ®å“¦ï¼å®‰å…¨ç¬¬ä¸€ï½
            </div>
            
            <div class="button-group">
                <button id="flashBtn" class="cute-button btn-connect" disabled>âœ¨ å¼€å§‹åˆ·å†™</button>
                <button id="eraseBtn" class="cute-button btn-warning">ğŸ§¹ æ“¦é™¤åˆ†åŒº</button>
            </div>
        </div>
        
        <!-- é«˜çº§åŠŸèƒ½ -->
        <div class="function-box">
            <h2><span class="emoji">âš™ï¸</span> é«˜çº§åŠŸèƒ½</h2>
            <p style="color: #888; margin-bottom: 15px;">è¿™äº›åŠŸèƒ½è¦å°å¿ƒä½¿ç”¨å“¦ï½ å¼„é”™äº†å¯ä¸å¥½ç©ï¼</p>
            
            <div class="button-group">
                <button id="tempBootBtn" class="cute-button btn-secondary" disabled>ğŸš€ ä¸´æ—¶å¯åŠ¨</button>
                <input type="file" id="bootFile" accept=".img" style="display: none;" />
                <button id="wipeBtn" class="cute-button btn-warning">ğŸ’¥ æ¸…é™¤æ•°æ®</button>
                <button id="unlockBtn" class="cute-button btn-danger">ğŸ”“ è§£é”Bootloader</button>
                <button id="lockBtn" class="cute-button btn-secondary">ğŸ”’ é”å®šBootloader</button>
            </div>
        </div>
        
        <!-- æ“ä½œæ—¥å¿— -->
        <div class="function-box">
            <h2><span class="emoji">ğŸ“</span> æ“ä½œæ—¥å¿—</h2>
            <div class="button-group">
                <button id="clearLogBtn" class="cute-button btn-secondary">ğŸ§¹ æ¸…ç©ºæ—¥å¿—</button>
            </div>
            <div id="logContainer" class="log-box">
                <div class="log-entry log-info">
                    <span class="log-time">[åˆšåˆš]</span> ğŸŒ¸ æ¬¢è¿ä½¿ç”¨æºæºåˆ·æœºåŠ©æ‰‹ï¼
                </div>
                <div class="log-entry log-info">
                    <span class="log-time">[åˆšåˆš]</span> ğŸ’– è¯·è¿æ¥ä½ çš„æ‰‹æœºå¼€å§‹ä½¿ç”¨å§ï½
                </div>
            </div>
        </div>
        
        <!-- åº•éƒ¨æç¤º -->
        <div class="footer">
            <p>ğŸŒ¸ ä½¿ç”¨æ–¹æ³•ï¼š</p>
            <p>1. ç”¨OTGçº¿è¿æ¥æ‰‹æœºå’Œç”µè„‘</p>
            <p>2. æ‰‹æœºè¿›å…¥Fastbootæ¨¡å¼ï¼ˆå…³æœºåæŒ‰éŸ³é‡ä¸‹+ç”µæºé”®ï¼‰</p>
            <p>3. ç‚¹å‡»"è¿æ¥è®¾å¤‡"ï¼Œåœ¨å¼¹çª—ä¸­é€‰æ‹©ä½ çš„æ‰‹æœº</p>
            <p>4. å¼€å§‹äº«å—åˆ·æœºçš„ä¹è¶£å§ï¼</p>
            <p style="margin-top: 15px; font-size: 0.8rem; color: #ff7eb9;">
                æ³¨æ„ï¼šåˆ·æœºæœ‰é£é™©ï¼Œæ“ä½œéœ€è°¨æ…ï¼è®°å¾—å¤‡ä»½é‡è¦æ•°æ®å“¦ï½
            </p>
        </div>
    </div>

    <script>
        class YuanYuanFlashTool {
            constructor() {
                this.device = null;
                this.connected = false;
                this.endpointIn = null;
                this.endpointOut = null;
                this.isTransferring = false;
                this.hasAgreed = localStorage.getItem('yuanyuan_agreed') === 'true';
                this.init();
            }
            
            init() {
                this.addLog('å¯åŠ¨', 'æºæºåˆ·æœºåŠ©æ‰‹å¯åŠ¨å®Œæˆï¼', 'info');
                this.addLog('æç¤º', 'å…ˆè¿æ¥æ‰‹æœºæ‰èƒ½å¼€å§‹ç©å“¦ï½', 'info');
                this.checkBrowserSupport();
                this.bindEvents();
                
                // å¦‚æœç”¨æˆ·è¿˜æ²¡åŒæ„ï¼Œæ˜¾ç¤ºæ•™ç¨‹
                if (!this.hasAgreed) {
                    setTimeout(() => {
                        this.showTutorial();
                    }, 1000);
                }
            }
            
            bindEvents() {
                // æ•™ç¨‹ç›¸å…³
                document.getElementById('helpButton').onclick = () => this.showTutorial();
                document.getElementById('closeTutorial').onclick = () => this.hideTutorial();
                document.getElementById('agreeButton').onclick = () => this.agreeTutorial();
                document.getElementById('agreeCheckbox').onchange = (e) => {
                    document.getElementById('agreeButton').disabled = !e.target.checked;
                };
                
                // è®¾å¤‡è¿æ¥
                document.getElementById('connectBtn').onclick = () => this.connectDevice();
                document.getElementById('disconnectBtn').onclick = () => this.disconnectDevice();
                document.getElementById('refreshBtn').onclick = () => this.refreshStatus();
                
                // å‘½ä»¤æ‰§è¡Œ
                document.getElementById('executeBtn').onclick = () => this.executeCommand();
                document.getElementById('clearResultBtn').onclick = () => this.showResult('æ¸…ç©ºå•¦ï½ è¯•è¯•è¾“å…¥å‘½ä»¤å§ï¼');
                document.getElementById('commandInput').onkeypress = (e) => {
                    if (e.key === 'Enter') this.executeCommand();
                };
                
                // åˆ·å†™åŠŸèƒ½
                document.getElementById('flashBtn').onclick = () => this.flashPartition();
                document.getElementById('flashFile').onchange = (e) => this.handleFileSelect(e);
                document.getElementById('eraseBtn').onclick = () => this.erasePartition();
                
                // é«˜çº§åŠŸèƒ½
                document.getElementById('tempBootBtn').onclick = () => document.getElementById('bootFile').click();
                document.getElementById('bootFile').onchange = (e) => this.tempBoot(e);
                document.getElementById('wipeBtn').onclick = () => this.wipeData();
                document.getElementById('unlockBtn').onclick = () => this.unlockBootloader();
                document.getElementById('lockBtn').onclick = () => this.lockBootloader();
                
                // æ—¥å¿—
                document.getElementById('clearLogBtn').onclick = () => this.clearLogs();
            }
            
            showTutorial() {
                document.getElementById('tutorialModal').style.display = 'flex';
            }
            
            hideTutorial() {
                document.getElementById('tutorialModal').style.display = 'none';
            }
            
            agreeTutorial() {
                this.hasAgreed = true;
                localStorage.setItem('yuanyuan_agreed', 'true');
                this.hideTutorial();
                this.addLog('æ•™ç¨‹', 'ç”¨æˆ·å·²é˜…è¯»å¹¶åŒæ„æ•™ç¨‹å†…å®¹', 'success');
                this.showResult('ğŸ‰ å¤ªå¥½äº†ï¼ç°åœ¨å¯ä»¥å¼€å§‹ä½¿ç”¨åˆ·æœºåŠ©æ‰‹å•¦ï½\n\nè®°å¾—å…ˆè¿æ¥æ‰‹æœºå“¦ï¼');
            }
            
            async checkBrowserSupport() {
                if (!navigator.usb) {
                    this.updateStatus('âŒ å“å‘€ï¼Œæµè§ˆå™¨ä¸æ”¯æŒå‘¢ï½ è¦ç”¨Edgeæˆ–Chromeå“¦ï¼', false);
                    this.addLog('é”™è¯¯', 'æµè§ˆå™¨ä¸æ”¯æŒWebUSBï¼Œè¦ç”¨Edge 89+æˆ–Chrome 89+æ‰è¡Œ', 'error');
                    this.disableButtons();
                } else {
                    this.updateStatus('âœ… æµè§ˆå™¨æ”¯æŒWebUSBï¼Œå¯ä»¥å¼€å§‹è¿æ¥å•¦ï¼', true);
                }
            }
            
            async connectDevice() {
                try {
                    this.addLog('è¿æ¥', 'æ­£åœ¨æ‰¾æ‰‹æœº... è¦ç¡®ä¿æ‰‹æœºè¿›å…¥Fastbootæ¨¡å¼å“¦ï¼', 'info');
                    this.updateStatus('æ­£åœ¨æ‰¾æ‰‹æœº...', false);
                    
                    this.device = await navigator.usb.requestDevice({
                        filters: [{ classCode: 0xFF, subclassCode: 0x42 }]
                    });
                    
                    if (!this.device) {
                        this.addLog('æç¤º', 'æ²¡æœ‰é€‰æ‹©è®¾å¤‡å‘¢ï½', 'warning');
                        return;
                    }
                    
                    this.addLog('å‘ç°', `æ‰¾åˆ°è®¾å¤‡å•¦ï¼š${this.device.productName || 'æœªçŸ¥è®¾å¤‡'}`, 'info');
                    this.updateStatus('æ­£åœ¨è¿æ¥è®¾å¤‡...', false);
                    
                    await this.device.open();
                    
                    if (this.device.configuration === null) {
                        await this.device.selectConfiguration(1);
                    }
                    
                    // æ‰¾Fastbootæ¥å£
                    let foundInterface = false;
                    for (const iface of this.device.configuration.interfaces) {
                        for (const alt of iface.alternates) {
                            if (alt.interfaceClass === 0xFF) {
                                this.endpointIn = alt.endpoints.find(e => e.direction === 'in');
                                this.endpointOut = alt.endpoints.find(e => e.direction === 'out');
                                
                                if (this.endpointIn && this.endpointOut) {
                                    await this.device.claimInterface(iface.interfaceNumber);
                                    foundInterface = true;
                                    break;
                                }
                            }
                        }
                        if (foundInterface) break;
                    }
                    
                    if (!this.endpointIn || !this.endpointOut) {
                        throw new Error('æ‰¾ä¸åˆ°Fastbootæ¥å£å‘¢ï½ æ˜¯ä¸æ˜¯æ²¡è¿›Fastbootæ¨¡å¼ï¼Ÿ');
                    }
                    
                    this.connected = true;
                    this.updateStatus(`âœ… è¿æ¥æˆåŠŸï¼å¯ä»¥å¼€å§‹ç©å•¦ï½`, true);
                    this.addLog('æˆåŠŸ', 'è®¾å¤‡è¿æ¥æˆåŠŸï¼ç°åœ¨å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†', 'success');
                    this.showResult(`ğŸ‰ è€¶ï¼è¿æ¥æˆåŠŸå•¦ï¼\n\nğŸ“± è®¾å¤‡ä¿¡æ¯ï¼š\nâ€¢ å‚å•†ID: 0x${this.device.vendorId.toString(16)}\nâ€¢ äº§å“ID: 0x${this.device.productId.toString(16)}\nâ€¢ è®¾å¤‡å: ${this.device.productName || 'æœªçŸ¥'}\n\nğŸ’• ç°åœ¨å¯ä»¥å¼€å§‹åˆ·æœºäº†ï½`);
                    
                    document.getElementById('connectBtn').disabled = true;
                    document.getElementById('disconnectBtn').disabled = false;
                    document.getElementById('flashBtn').disabled = false;
                    document.getElementById('tempBootBtn').disabled = false;
                    
                } catch (error) {
                    this.updateStatus('âŒ è¿æ¥å¤±è´¥... å‘œå‘œ', false);
                    this.addLog('é”™è¯¯', `è¿æ¥å¤±è´¥: ${error.message}`, 'error');
                    this.showResult(`ğŸ˜¢ è¿æ¥å¤±è´¥...\n\né”™è¯¯ï¼š${error.message}\n\nğŸ’¡ è¯•è¯•è¿™æ ·ï¼š\n1. æ‰‹æœºè¿›å…¥Fastbootæ¨¡å¼ï¼ˆå…³æœºåæŒ‰éŸ³é‡ä¸‹+ç”µæºé”®ï¼‰\n2. ç”¨OTGçº¿è¿æ¥ç”µè„‘\n3. å…è®¸æµè§ˆå™¨è®¿é—®USBè®¾å¤‡\n4. å†è¯•ä¸€æ¬¡çœ‹çœ‹ï½`);
                }
            }
            
            disconnectDevice() {
                if (this.device && this.device.opened) {
                    this.device.close();
                }
                this.device = null;
                this.connected = false;
                this.updateStatus('ğŸ”Œ è®¾å¤‡æ–­å¼€å•¦ï½ è®°å¾—å®‰å…¨ç§»é™¤å“¦ï¼', false);
                this.addLog('æ–­å¼€', 'è®¾å¤‡å·²æ–­å¼€è¿æ¥', 'info');
                
                document.getElementById('connectBtn').disabled = false;
                document.getElementById('disconnectBtn').disabled = true;
                document.getElementById('flashBtn').disabled = true;
                document.getElementById('tempBootBtn').disabled = true;
            }
            
            updateStatus(text, isConnected) {
                const dot = document.getElementById('statusDot');
                const textEl = document.getElementById('statusText');
                
                textEl.textContent = text;
                if (isConnected) {
                    dot.classList.add('connected');
                } else {
                    dot.classList.remove('connected');
                }
            }
            
            disableButtons() {
                document.querySelectorAll('.cute-button').forEach(btn => {
                    if (!btn.id.includes('connect')) {
                        btn.disabled = true;
                    }
                });
            }
            
            async executeCommand() {
                const input = document.getElementById('commandInput');
                const command = input.value.trim();
                
                if (!command) {
                    this.showResult('ğŸ’« è¦è¾“å…¥å‘½ä»¤æ‰èƒ½æ‰§è¡Œå“¦ï½');
                    return;
                }
                
                if (!this.connected) {
                    this.showResult('ğŸ”Œ è¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½ å…ˆè¿æ¥æ‰‹æœºå§ï¼');
                    return;
                }
                
                this.addLog('å‘½ä»¤', `æ‰§è¡Œ: ${command}`, 'info');
                
                try {
                    const response = await this.sendCommand(command);
                    this.showResult(`âœ¨ æ‰§è¡ŒæˆåŠŸï¼\n\n${response}`);
                    this.addLog('æˆåŠŸ', 'å‘½ä»¤æ‰§è¡Œå®Œæˆ', 'success');
                } catch (error) {
                    this.showResult(`ğŸ˜¢ æ‰§è¡Œå¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                    this.addLog('é”™è¯¯', `å‘½ä»¤å¤±è´¥: ${error.message}`, 'error');
                }
            }
            
            async sendCommand(command) {
                if (!this.device || !this.connected) {
                    throw new Error('è®¾å¤‡æ²¡è¿æ¥å‘¢ï½');
                }
                
                const commandStr = command + '\0';
                const data = new TextEncoder().encode(commandStr);
                
                await this.device.transferOut(this.endpointOut.endpointNumber, data);
                
                const result = await this.device.transferIn(this.endpointIn.endpointNumber, 64);
                const responseData = new Uint8Array(result.data.buffer);
                
                let endIndex = 0;
                while (endIndex < responseData.length && responseData[endIndex] !== 0) {
                    endIndex++;
                }
                
                return new TextDecoder().decode(responseData.slice(0, endIndex));
            }
            
            handleFileSelect(event) {
                const file = event.target.files[0];
                if (file) {
                    this.addLog('æ–‡ä»¶', `é€‰æ‹©äº†æ–‡ä»¶: ${file.name} (${this.formatSize(file.size)})`, 'info');
                }
            }
            
            async flashPartition() {
                if (!this.connected) {
                    this.showResult('ğŸ”Œ è¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½');
                    return;
                }
                
                const fileInput = document.getElementById('flashFile');
                const partitionInput = document.getElementById('flashPartition');
                
                if (!fileInput.files.length) {
                    this.showResult('ğŸ“ è¦é€‰æ‹©é•œåƒæ–‡ä»¶å“¦ï½');
                    return;
                }
                
                const partition = partitionInput.value.trim();
                if (!partition) {
                    this.showResult('âœï¸ è¦è¾“å…¥åˆ†åŒºåç§°å‘¢ï½');
                    return;
                }
                
                const file = fileInput.files[0];
                if (!confirm(`ç¡®å®šè¦åˆ·å†™ ${partition} åˆ†åŒºå—ï¼Ÿ\næ–‡ä»¶: ${file.name}\nå¤§å°: ${this.formatSize(file.size)}\n\nâš ï¸ åˆ·æœºæœ‰é£é™©ï¼Œè®°å¾—å¤‡ä»½å“¦ï¼`)) {
                    return;
                }
                
                this.addLog('åˆ·å†™', `å¼€å§‹åˆ·å†™ ${partition} åˆ†åŒº`, 'warning');
                
                try {
                    this.showProgress(true);
                    
                    const reader = new FileReader();
                    
                    return new Promise((resolve, reject) => {
                        reader.onload = async (e) => {
                            try {
                                const data = new Uint8Array(e.target.result);
                                
                                this.updateProgress(0, 'å‡†å¤‡ä¸­...');
                                this.showResult(`å‡†å¤‡åˆ·å†™ ${partition} åˆ†åŒº...\næ–‡ä»¶å¤§å°: ${this.formatSize(data.length)}`);
                                
                                this.updateProgress(10, 'å‘é€ä¸‹è½½å‘½ä»¤...');
                                await this.sendCommand(`download:${data.length.toString(16)}`);
                                
                                this.updateProgress(20, 'å‘é€é•œåƒæ•°æ®...');
                                await this.sendData(data);
                                
                                this.updateProgress(80, 'æ‰§è¡Œåˆ·å†™å‘½ä»¤...');
                                const result = await this.sendCommand(`flash:${partition}`);
                                
                                this.updateProgress(100, 'å®Œæˆå•¦ï¼ğŸ‰');
                                this.showResult(`ğŸ‰ ${partition} åˆ†åŒºåˆ·å†™æˆåŠŸï¼\n\n${result}`);
                                this.addLog('æˆåŠŸ', `${partition} åˆ†åŒºåˆ·å†™å®Œæˆ`, 'success');
                                
                                setTimeout(() => this.showProgress(false), 2000);
                                resolve();
                                
                            } catch (error) {
                                this.showProgress(false);
                                this.showResult(`ğŸ˜¢ åˆ·å†™å¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                                this.addLog('é”™è¯¯', `åˆ·å†™å¤±è´¥: ${error.message}`, 'error');
                                reject(error);
                            }
                        };
                        
                        reader.onerror = (error) => {
                            this.showProgress(false);
                            this.showResult(`ğŸ˜¢ æ–‡ä»¶è¯»å–å¤±è´¥...\n\né”™è¯¯ï¼š${error}`);
                            this.addLog('é”™è¯¯', 'æ–‡ä»¶è¯»å–å¤±è´¥', 'error');
                            reject(error);
                        };
                        
                        reader.readAsArrayBuffer(file);
                    });
                    
                } catch (error) {
                    this.showProgress(false);
                    this.showResult(`ğŸ˜¢ åˆ·å†™å¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                    this.addLog('é”™è¯¯', `åˆ·å†™å¤±è´¥: ${error.message}`, 'error');
                }
            }
            
            async sendData(data) {
                if (!this.device || !this.connected) {
                    throw new Error('è®¾å¤‡æ²¡è¿æ¥å‘¢ï½');
                }
                
                const chunkSize = 64 * 1024;
                
                for (let i = 0; i < data.length; i += chunkSize) {
                    const chunk = data.slice(i, Math.min(i + chunkSize, data.length));
                    await this.device.transferOut(this.endpointOut.endpointNumber, chunk);
                    
                    const progress = Math.round((i + chunk.length) / data.length * 100);
                    this.updateProgress(20 + (progress * 0.6), `ä¼ è¾“ä¸­: ${progress}%`);
                }
            }
            
            async tempBoot(event) {
                if (!this.connected) {
                    this.showResult('ğŸ”Œ è¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½');
                    return;
                }
                
                const file = event.target.files[0];
                if (!file) return;
                
                if (!confirm(`ç¡®å®šè¦ä¸´æ—¶å¯åŠ¨è¿™ä¸ªé•œåƒå—ï¼Ÿ\næ–‡ä»¶: ${file.name}\n\nâš ï¸ è¿™ä¸ªåªæ˜¯ä¸´æ—¶å¯åŠ¨ï¼Œé‡å¯å°±æ¢å¤å•¦ï½`)) {
                    return;
                }
                
                this.addLog('å¯åŠ¨', 'å¼€å§‹ä¸´æ—¶å¯åŠ¨é•œåƒ', 'warning');
                
                try {
                    this.showProgress(true);
                    
                    const reader = new FileReader();
                    
                    return new Promise((resolve, reject) => {
                        reader.onload = async (e) => {
                            try {
                                const data = new Uint8Array(e.target.result);
                                
                                this.updateProgress(0, 'å‡†å¤‡ä¸­...');
                                this.showResult(`å‡†å¤‡ä¸´æ—¶å¯åŠ¨é•œåƒ...\næ–‡ä»¶å¤§å°: ${this.formatSize(data.length)}`);
                                
                                this.updateProgress(20, 'å‘é€ä¸‹è½½å‘½ä»¤...');
                                await this.sendCommand(`download:${data.length.toString(16)}`);
                                
                                this.updateProgress(30, 'å‘é€é•œåƒæ•°æ®...');
                                await this.sendData(data);
                                
                                this.updateProgress(80, 'æ‰§è¡Œå¯åŠ¨å‘½ä»¤...');
                                const result = await this.sendCommand('boot');
                                
                                this.updateProgress(100, 'å¯åŠ¨å‘½ä»¤å‘é€æˆåŠŸï¼');
                                this.showResult(`âœ¨ ä¸´æ—¶å¯åŠ¨å‘½ä»¤å‘é€æˆåŠŸï¼\n\n${result}\n\nè®¾å¤‡ä¼šé‡å¯åˆ°è¿™ä¸ªé•œåƒï½`);
                                this.addLog('æˆåŠŸ', 'ä¸´æ—¶å¯åŠ¨å‘½ä»¤å·²å‘é€', 'success');
                                
                                setTimeout(() => this.showProgress(false), 2000);
                                resolve();
                                
                            } catch (error) {
                                this.showProgress(false);
                                this.showResult(`ğŸ˜¢ å¯åŠ¨å¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                                this.addLog('é”™è¯¯', `å¯åŠ¨å¤±è´¥: ${error.message}`, 'error');
                                reject(error);
                            }
                        };
                        
                        reader.readAsArrayBuffer(file);
                    });
                    
                } catch (error) {
                    this.showProgress(false);
                    this.showResult(`ğŸ˜¢ å¯åŠ¨å¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                    this.addLog('é”™è¯¯', `å¯åŠ¨å¤±è´¥: ${error.message}`, 'error');
                }
                
                event.target.value = '';
            }
            
            async erasePartition() {
                if (!this.connected) {
                    this.showResult('ğŸ”Œ è¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½');
                    return;
                }
                
                const partition = prompt('è¦æ“¦é™¤å“ªä¸ªåˆ†åŒºå‘¢ï¼Ÿ', 'userdata');
                if (!partition) return;
                
                if (!confirm(`ç¡®å®šè¦æ“¦é™¤ ${partition} åˆ†åŒºå—ï¼Ÿ\n\nâš ï¸ è­¦å‘Šï¼šè¿™ä¼šæ¸…é™¤è¿™ä¸ªåˆ†åŒºçš„æ‰€æœ‰æ•°æ®ï¼`)) {
                    return;
                }
                
                this.addLog('æ“¦é™¤', `æ“¦é™¤åˆ†åŒº: ${partition}`, 'warning');
                
                try {
                    const result = await this.sendCommand(`erase:${partition}`);
                    this.showResult(`ğŸ§¹ ${partition} åˆ†åŒºæ“¦é™¤å®Œæˆï¼\n\n${result}`);
                    this.addLog('æˆåŠŸ', `åˆ†åŒº ${partition} æ“¦é™¤å®Œæˆ`, 'success');
                } catch (error) {
                    this.showResult(`ğŸ˜¢ æ“¦é™¤å¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                    this.addLog('é”™è¯¯', `æ“¦é™¤å¤±è´¥: ${error.message}`, 'error');
                }
            }
            
            async wipeData() {
                if (!this.connected) {
                    this.showResult('ğŸ”Œ è¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½');
                    return;
                }
                
                if (!confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰ç”¨æˆ·æ•°æ®å—ï¼Ÿ\n\nâš ï¸ è­¦å‘Šï¼šè¿™ä¼šæ¸…é™¤è®¾å¤‡ä¸Šçš„æ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼\nç…§ç‰‡ã€è”ç³»äººä»€ä¹ˆçš„éƒ½ä¼šæ²¡çš„ï¼')) {
                    return;
                }
                
                this.addLog('æ¸…é™¤', 'æ¸…é™¤ç”¨æˆ·æ•°æ®', 'warning');
                
                try {
                    const result = await this.sendCommand('erase:userdata');
                    this.showResult(`ğŸ’¥ ç”¨æˆ·æ•°æ®æ¸…é™¤å®Œæˆï¼\n\n${result}\n\næ‰€æœ‰ç”¨æˆ·æ•°æ®éƒ½æ²¡å•¦ï½`);
                    this.addLog('æˆåŠŸ', 'ç”¨æˆ·æ•°æ®æ¸…é™¤å®Œæˆ', 'success');
                } catch (error) {
                    this.showResult(`ğŸ˜¢ æ¸…é™¤å¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                    this.addLog('é”™è¯¯', `æ¸…é™¤å¤±è´¥: ${error.message}`, 'error');
                }
            }
            
            async unlockBootloader() {
                if (!this.connected) {
                    this.showResult('ğŸ”Œ è¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½');
                    return;
                }
                
                if (!confirm('ç¡®å®šè¦è§£é”Bootloaderå—ï¼Ÿ\n\nâš ï¸ é‡è¦è­¦å‘Šï¼š\n1. è¿™ä¼šæ¸…é™¤æ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼\n2. å¯èƒ½ä¼šè®©ä¿ä¿®å¤±æ•ˆï¼\n3. æ“ä½œå¯èƒ½ä¸å¯é€†ï¼')) {
                    return;
                }
                
                this.addLog('è§£é”', 'è§£é”Bootloader', 'warning');
                
                try {
                    const result = await this.sendCommand('oem unlock');
                    this.showResult(`ğŸ”“ Bootloaderè§£é”å‘½ä»¤å‘é€æˆåŠŸï¼\n\n${result}\n\nè®¾å¤‡å¯èƒ½ä¼šé‡å¯å¹¶æ¸…é™¤æ•°æ®ï½`);
                    this.addLog('æˆåŠŸ', 'Bootloaderè§£é”å‘½ä»¤å·²å‘é€', 'success');
                } catch (error) {
                    this.showResult(`ğŸ˜¢ è§£é”å¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                    this.addLog('é”™è¯¯', `è§£é”å¤±è´¥: ${error.message}`, 'error');
                }
            }
            
            async lockBootloader() {
                if (!this.connected) {
                    this.showResult('ğŸ”Œ è¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½');
                    return;
                }
                
                if (!confirm('ç¡®å®šè¦é”å®šBootloaderå—ï¼Ÿ\n\nâš ï¸ è­¦å‘Šï¼šé”å®šåå¯èƒ½æ— æ³•å†æ¬¡è§£é”ï¼')) {
                    return;
                }
                
                this.addLog('é”å®š', 'é”å®šBootloader', 'warning');
                
                try {
                    const result = await this.sendCommand('oem lock');
                    this.showResult(`ğŸ”’ Bootloaderé”å®šå‘½ä»¤å‘é€æˆåŠŸï¼\n\n${result}`);
                    this.addLog('æˆåŠŸ', 'Bootloaderé”å®šå‘½ä»¤å·²å‘é€', 'success');
                } catch (error) {
                    this.showResult(`ğŸ˜¢ é”å®šå¤±è´¥...\n\né”™è¯¯ï¼š${error.message}`);
                    this.addLog('é”™è¯¯', `é”å®šå¤±è´¥: ${error.message}`, 'error');
                }
            }
            
            refreshStatus() {
                if (!this.connected) {
                    this.showResult('ğŸ”Œ è¿˜æ²¡è¿æ¥è®¾å¤‡å‘¢ï½ å…ˆè¿æ¥æ‰‹æœºå§ï¼');
                    return;
                }
                
                this.executeCommand('getvar all');
            }
            
            showResult(text) {
                document.getElementById('resultBox').textContent = text;
            }
            
            updateProgress(percent, text) {
                const container = document.getElementById('progressContainer');
                const fill = document.getElementById('progressFill');
                const textEl = document.getElementById('progressText');
                
                fill.style.width = `${percent}%`;
                textEl.textContent = text;
                
                if (percent === 0) {
                    container.style.display = 'block';
                }
            }
            
            showProgress(show) {
                document.getElementById('progressContainer').style.display = show ? 'block' : 'none';
                if (!show) {
                    this.updateProgress(0, 'ç­‰å¾…å¼€å§‹...');
                }
            }
            
            addLog(type, message, level = 'info') {
                const time = new Date().toLocaleTimeString('zh-CN', { 
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${level}`;
                logEntry.innerHTML = `<span class="log-time">[${time}]</span> ${type}: ${message}`;
                
                const container = document.getElementById('logContainer');
                container.appendChild(logEntry);
                container.scrollTop = container.scrollHeight;
            }
            
            clearLogs() {
                const container = document.getElementById('logContainer');
                container.innerHTML = '<div class="log-entry log-info"><span class="log-time">[åˆšåˆš]</span> æ—¥å¿—æ¸…ç©ºå•¦ï½ é‡æ–°å¼€å§‹è®°å½•ï¼</div>';
            }
            
            formatSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
        }
        
        // å¯åŠ¨å·¥å…·
        document.addEventListener('DOMContentLoaded', () => {
            window.yuanyuanTool = new YuanYuanFlashTool();
        });
        
        // ç‚¹å‡»å¼¹çª—å¤–åŒºåŸŸå…³é—­å¼¹çª—
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('tutorial-modal')) {
                document.getElementById('tutorialModal').style.display = 'none';
            }
        });
    </script>
</body>
</html>

